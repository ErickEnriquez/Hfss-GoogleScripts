<!DOCTYPE html>
<html>
  <head>
    <base target="_top" />
  </head>
  <body>
    <label for="ta">
      Enter your Text Message Here. If you want to enter in smart tags use {A} -
      {E}. corresponding to the column you want to add in </label
    ><br />
    <!-- Create Text Area to grab the users message-->
    <textarea
      id="ta"
      rows="15"
      cols="30"
      placeholder="Hi {A} this is a link to form blah blah ..."
    ></textarea>
    <!-- Create a button to send the value to the spreadsheet -->
    <br />
    <br />
    <label for="headerRows">Check here if first row contains headers</label>
    <input
      type="checkbox"
      id="headerRows"
      value="True"
      default="False"
    />
    <br /><br />
    <label for="phoneColumn">Which column are phone numbers in</label>
    <select id="phoneColumn" required>
      <option value="blank"></option>
      <option value="A">A</option>
      <option value="B">B</option>
      <option value="C">C</option>
      <option value="D">D</option>
      <option value="E">E</option>
      <option value="F">F</option>
    </select>
    <br />
    <br />

    <button onclick="clickSubmitHandler()">Submit</button>
    <script>
      function clickSubmitHandler() {
        //Get the value of the input field
        let res = {
          message: document.getElementById("ta").value,
          headerRows: document.getElementById("headerRows").checked,
          phoneNumberColumn: document.getElementById("phoneColumn").value,
        };
        google.script.run.sendOutTexts(res);
        google.script.run();
      }

    </script>
  </body>
</html>
